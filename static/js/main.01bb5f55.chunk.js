(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{104:function(e,t,n){},107:function(e,t,n){},108:function(e,t,n){},111:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(25),c=n.n(a),s=(n(98),n(99),n(11)),o=n(12),i=n.n(o),u=n(17),l=n(7),j=n(122),d=n(82),b=n(2);var p=function(e){var t=e.loginHandle,n=Object(r.useState)(""),a=Object(l.a)(n,2),c=a[0],s=a[1],o=Object(r.useState)(""),i=Object(l.a)(o,2),u=i[0],p=i[1];return Object(b.jsx)("div",{children:Object(b.jsxs)(j.a,{children:[Object(b.jsxs)(j.a.Group,{className:"mb-3",controlId:"formEmail",children:[Object(b.jsx)(j.a.Label,{children:"Email"}),Object(b.jsx)(j.a.Control,{type:"email",placeholder:"Enter email",value:c,onChange:function(e){return s(e.target.value)}})]}),Object(b.jsxs)(j.a.Group,{className:"mb-3",controlId:"formPassword",children:[Object(b.jsx)(j.a.Label,{children:"Password"}),Object(b.jsx)(j.a.Control,{type:"password",placeholder:"Enter password",value:u,onChange:function(e){return p(e.target.value)}})]}),Object(b.jsx)(d.a,{onClick:function(){return t(c,u)},children:"Login"})]})})},h=(n(104),n(35)),O=function(){var e=Object(u.a)(i.a.mark((function e(t){var n,r,a,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.email,r=t.password,e.next=3,fetch("".concat("https://classmanagement-server.herokuapp.com/api","/user/login"),{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({email:n,password:r})});case 3:return a=e.sent,e.next=6,a.json();case 6:if(!(c=e.sent).error){e.next=9;break}throw c.error;case 9:return e.abrupt("return",c.token);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(u.a)(i.a.mark((function e(t){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat("https://classmanagement-server.herokuapp.com/api","/user/authenticate"),{headers:new Headers({"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer ".concat(t)}),method:"POST"});case 2:return n=e.sent,e.next=5,n.json();case 5:if(!(r=e.sent).error){e.next=8;break}throw r.error;case 8:return e.abrupt("return",r.user);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x="LOGIN",v="LOGOUT",m=n(117);var g=function(e){var t,n=Object(h.d)((function(e){return e.token})),a=Object(s.f)(),c=Object(h.c)(),o=Object(r.useState)(null),j=Object(l.a)(o,2),d=j[0],f=j[1];Object(r.useEffect)((function(){var t,r;if(n)return a.push("/");(null===(t=e.location.state)||void 0===t?void 0:t.errorMsg)&&f(null===(r=e.location.state)||void 0===r?void 0:r.errorMsg.toString())}),[null===(t=e.location.state)||void 0===t?void 0:t.errorMsg]);var v=function(){var e=Object(u.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O({email:t,password:n});case 3:r=e.sent,c({type:x,token:r}),a.push("/"),e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(0),"TypeError: Failed to fetch"!==e.t0.toString()){e.next=12;break}return e.abrupt("return",f("Can't connect to server"));case 12:return e.abrupt("return",f(e.t0.toString()));case 13:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(b.jsxs)("div",{className:"Login",children:[d&&Object(b.jsx)(m.a,{variant:"danger",children:d}),Object(b.jsx)(p,{loginHandle:v})]})},k=n(119),y=n(120),w=n(81),C=n(125),S=n(118),I=n(126),N=n(87),T=n(86),L=n(85),H=(n(107),n(124));function F(e){var t=e.classroom,n=Object(r.useState)(null),a=Object(l.a)(n,2),c=a[0],s=a[1],o=Object(r.useState)(null),j=Object(l.a)(o,2),d=j[0],p=j[1],h=Object(r.useState)(null),O=Object(l.a)(h,2),f=O[0],x=O[1],v=Object(r.useState)(!1),g=Object(l.a)(v,2),k=g[0],y=g[1];Object(r.useEffect)((function(){var e=function(){var e=Object(u.a)(i.a.mark((function e(){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://classmanagement-server.herokuapp.com/api"+"/class/".concat(t.classId));case 3:return n=e.sent,e.next=6,n.json();case 6:return r=e.sent,s(r.id+"-"+r.name),e.next=10,fetch("https://classmanagement-server.herokuapp.com/api"+"/class/".concat(t.classId,"/getstudents"));case 10:return n=e.sent,e.next=13,n.json();case 13:return r=e.sent,x(r.length),e.next=17,fetch("https://classmanagement-server.herokuapp.com/api"+"/class/".concat(t.classId,"/getteachers"));case 17:return n=e.sent,e.next=20,n.json();case 20:r=e.sent,p(r),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(0),alert(e.t0.toString());case 27:case"end":return e.stop()}}),e,null,[[0,24]])})));return function(){return e.apply(this,arguments)}}();e()}),[]);var w=function(){var e=Object(u.a)(i.a.mark((function e(){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),e.next=3,fetch("https://classmanagement-server.herokuapp.com/api"+"/class/".concat(t.classId,"/invitedtoken"));case 3:return n=e.sent,e.next=6,n.json();case 6:r=e.sent,navigator.clipboard.writeText(r||""),setTimeout((function(){y(!1)}),1e3);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(H.a,{show:k,children:Object(b.jsxs)(m.a,{variant:"success",children:[Object(b.jsx)(L.a,{}),"Invite code copied!"]})}),Object(b.jsxs)(C.a,{children:[Object(b.jsxs)(C.a.Header,{as:"h5",children:[c,Object(b.jsx)(T.a,{className:"float-end",onClick:w})]}),Object(b.jsx)(C.a.Body,{children:Object(b.jsxs)("ul",{children:[Object(b.jsxs)("li",{children:[Object(b.jsx)("strong",{children:"Students:"})," ",f||Object(b.jsx)(S.a,{animation:"grow"})]}),Object(b.jsxs)("li",{children:[Object(b.jsx)("strong",{children:"Teachers:"}),d?Object(b.jsx)("ul",{children:d.map((function(e){return Object(b.jsxs)("li",{children:[" ",Object(b.jsx)(N.a,{})," ",e.name]},e.id)}))}):Object(b.jsx)(S.a,{animation:"grow"})]})]})})]})]})}function E(e){var t=e.classes;return Object(b.jsx)(I.a,{variant:"flush",children:t.map((function(e){return Object(b.jsx)(I.a.Item,{children:Object(b.jsx)(F,{classroom:e})})}))})}function J(e){var t=e.user,n=Object(r.useState)(null),a=Object(l.a)(n,2),c=a[0],s=a[1];return Object(r.useEffect)((function(){var e=function(){var e=Object(u.a)(i.a.mark((function e(){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://classmanagement-server.herokuapp.com/api"+"/user/".concat(t.id,"/getclasses"));case 3:return n=e.sent,e.next=6,n.json();case 6:r=e.sent,s(r),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),alert(e.t0.toString());case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();e()}),[]),Object(b.jsx)("div",{className:"Home",children:Object(b.jsx)(k.a,{fluid:!0,children:Object(b.jsx)(y.a,{children:Object(b.jsx)(w.a,{sm:8,children:Object(b.jsxs)(C.a,{children:[Object(b.jsx)(C.a.Header,{as:"h5",children:"Class"}),Object(b.jsx)(C.a.Body,{children:c?Object(b.jsx)(E,{classes:c}):Object(b.jsx)(S.a,{class:"align-middle",animation:"grow"})})]})})})})})}var B=n(3),A=n(38),P=n(39),M=n(53),G=n(52),U=n(123),D=n(127),z=n(121),W=n(89);n(108);function q(e){var t=e.user,n=e.show,a=e.onHide,c=Object(r.useState)(null),s=Object(l.a)(c,2),o=s[0],p=s[1],h=Object(r.useState)(null),O=Object(l.a)(h,2),f=O[0],x=O[1],v=Object(r.useState)(!1),g=Object(l.a)(v,2),k=g[0],y=g[1],w=Object(r.useState)(null),C=Object(l.a)(w,2),I=C[0],N=C[1],T=function(){var e=Object(u.a)(i.a.mark((function e(){var n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return y(!0),e.prev=1,e.next=4,fetch("https://classmanagement-server.herokuapp.com/api/class",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({id:o,name:f})});case 4:return n=e.sent,e.next=7,n.json();case 7:return r=e.sent,console.log(r),e.next=11,fetch("https://classmanagement-server.herokuapp.com/api/user/addclass",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({classId:o,teacherId:t.id})});case 11:return n=e.sent,e.next=14,n.json();case 14:return r=e.sent,console.log(r),console.log(!0),y(!1),p(null),x(null),e.abrupt("return",a());case 23:if(e.prev=23,e.t0=e.catch(1),"TypeError: Failed to fetch"!==e.t0.toString()){e.next=27;break}return e.abrupt("return",N("Can't connect to server"));case 27:return e.abrupt("return",N(e.t0.toString()));case 28:case"end":return e.stop()}}),e,null,[[1,23]])})));return function(){return e.apply(this,arguments)}}(),L=function(){var e=Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(null),x(null),e.abrupt("return",a());case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(b.jsxs)(H.a,{show:n,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(b.jsx)(H.a.Header,{closeButton:!0,children:Object(b.jsx)(H.a.Title,{id:"contained-modal-title-vcenter",children:"Add new class"})}),Object(b.jsxs)(H.a.Body,{children:[I&&Object(b.jsx)(m.a,{variant:"danger",children:I}),Object(b.jsxs)(j.a,{children:[Object(b.jsxs)(j.a.Group,{className:"mb-3",controlId:"AddClassForm.Id",children:[Object(b.jsx)(j.a.Label,{children:"Class ID"}),Object(b.jsx)(j.a.Control,{type:"text",placeholder:"ABC001",value:o,onChange:function(e){return p(e.target.value)}})]}),Object(b.jsxs)(j.a.Group,{className:"mb-3",controlId:"AddClassForm.Name",children:[Object(b.jsx)(j.a.Label,{children:"Class Name"}),Object(b.jsx)(j.a.Control,{type:"text",placeholder:"To\xe1n Cao c\u1ea5p 1",value:f,onChange:function(e){return x(e.target.value)}})]})]})]}),Object(b.jsxs)(H.a.Footer,{children:[Object(b.jsx)(d.a,{onClick:L,variant:"secondary",children:"Close"}),Object(b.jsx)(d.a,{onClick:k?null:T,variant:"primary",disabled:k,children:k?Object(b.jsx)(S.a,{animation:"grow"}):"Add"})]})]})}function R(e){var t=e.user,n=e.show,a=e.onHide,c=Object(r.useState)(null),s=Object(l.a)(c,2),o=s[0],p=s[1],h=Object(r.useState)(!1),O=Object(l.a)(h,2),f=O[0],x=O[1],v=Object(r.useState)(null),g=Object(l.a)(v,2),k=g[0],y=g[1],w=function(){var e=Object(u.a)(i.a.mark((function e(){var n,r,c;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),e.prev=1,e.next=4,fetch("https://classmanagement-server.herokuapp.com/api"+"/user/joinclass/".concat(o),{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({userId:t.id})});case 4:return n=e.sent,e.next=7,n.json();case 7:if(r=e.sent,404!==n.status){e.next=12;break}if(!(null===(c=r.keyPattern)||void 0===c?void 0:c.id)){e.next=11;break}throw"Class ID has been used";case 11:throw r.error;case 12:return p(null),x(!1),e.abrupt("return",a());case 17:if(e.prev=17,e.t0=e.catch(1),x(!1),"TypeError: Failed to fetch"!==e.t0.toString()){e.next=22;break}return e.abrupt("return",y("Can't connect to server"));case 22:if("SyntaxError: Unexpected token < in JSON at position 0"!==e.t0.toString()){e.next=24;break}return e.abrupt("return",y("Invite code not exist"));case 24:return e.abrupt("return",y(e.t0.toString()));case 25:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(){return e.apply(this,arguments)}}(),C=function(){var e=Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(null),e.abrupt("return",a());case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(b.jsxs)(H.a,{show:n,size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0,children:[Object(b.jsx)(H.a.Header,{closeButton:!0,children:Object(b.jsx)(H.a.Title,{id:"contained-modal-title-vcenter",children:"Join a class"})}),Object(b.jsxs)(H.a.Body,{children:[k&&Object(b.jsx)(m.a,{variant:"danger",children:k}),Object(b.jsx)(j.a,{children:Object(b.jsxs)(j.a.Group,{className:"mb-3",controlId:"AddClassForm.Id",children:[Object(b.jsx)(j.a.Label,{children:"Invite Code"}),Object(b.jsx)(j.a.Control,{type:"text",placeholder:"Write code here ...",value:o,onChange:function(e){return p(e.target.value)}})]})})]}),Object(b.jsxs)(H.a.Footer,{children:[Object(b.jsx)(d.a,{onClick:C,variant:"secondary",children:"Close"}),Object(b.jsx)(d.a,{onClick:f?null:w,variant:"primary",disabled:f,children:f?Object(b.jsx)(S.a,{animation:"grow"}):"Join"})]})]})}function K(e){var t=e.user,n=Object(s.f)(),a=Object(h.c)(),c=Object(r.useState)(!1),o=Object(l.a)(c,2),i=o[0],u=o[1],j=Object(r.useState)(!1),d=Object(l.a)(j,2),p=d[0],O=d[1];return Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)(U.a,{bg:"light",expand:"lg",className:"Header flex",children:Object(b.jsxs)(k.a,{children:[Object(b.jsx)(U.a.Brand,{href:"/",children:"Class Management"}),Object(b.jsx)(U.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(b.jsxs)(U.a.Collapse,{id:"basic-navbar-nav",children:[Object(b.jsxs)(D.a,{className:"d-none d-md-flex",children:[Object(b.jsx)(D.a.Link,{href:"/",children:"Home"}),Object(b.jsx)(D.a.Link,{href:"/class",children:"Class"}),Object(b.jsx)(D.a.Link,{onClick:function(){O(!0)},children:"Join Class"}),!t.isStudent&&Object(b.jsx)(D.a.Link,{onClick:function(){u(!0)},children:"Add Class"})]}),Object(b.jsx)(D.a,{className:"ms-auto",children:Object(b.jsxs)(z.a,{className:"justify-content-end",title:Object(b.jsx)(W.a,{}),id:"basic-nav-dropdown",children:[Object(b.jsxs)(z.a.Item,{children:["Hello, ",t.name]}),Object(b.jsx)(z.a.Divider,{}),Object(b.jsx)(z.a.Item,{href:"/me/info",children:"My info"}),Object(b.jsx)(z.a.Item,{onClick:function(){return a({type:v}),n.push("/login")},children:"Logout"})]})})]})]})}),Object(b.jsx)(q,{user:t,show:i,onHide:function(){return u(!1)}}),Object(b.jsx)(R,{user:t,show:p,onHide:function(){return O(!1)}})]})}function Q(){return Object(b.jsx)("div",{})}var V=n(90),X=n.n(V);function Y(e){var t=function(t){Object(M.a)(r,t);var n=Object(G.a)(r);function r(){return Object(A.a)(this,r),n.apply(this,arguments)}return Object(P.a)(r,[{key:"render",value:function(){return console.log(this.props.user),Object(b.jsxs)("div",{className:X.a.Layout,children:[Object(b.jsx)(K,{user:this.props.user}),Object(b.jsx)(e,Object(B.a)({},this.props)),Object(b.jsx)(Q,{})]})}}]),r}(r.Component);return t}function Z(e){var t=Object(s.f)(),n=function(n){Object(M.a)(a,n);var r=Object(G.a)(a);function a(){var e;Object(A.a)(this,a);for(var n=arguments.length,c=new Array(n),s=0;s<n;s++)c[s]=arguments[s];return(e=r.call.apply(r,[this].concat(c))).state={user:null},e.getUserInfo=Object(u.a)(i.a.mark((function n(){var r;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.props.token){n.next=2;break}return n.abrupt("return",t.push({pathname:"/login",state:{errorMsg:"Require login"}}));case 2:return n.prev=2,n.next=5,f(e.props.token);case 5:return r=n.sent,n.abrupt("return",e.setState({user:r}));case 9:return n.prev=9,n.t0=n.catch(2),e.props.logout(),n.abrupt("return",t.push({pathname:"/login",state:{errorMsg:"Expired login"}}));case 13:case"end":return n.stop()}}),n,null,[[2,9]])}))),e}return Object(P.a)(a,[{key:"componentWillMount",value:function(){this.getUserInfo()}},{key:"componentWillUpdate",value:function(e){this.props.token!==e.token&&this.getUserInfo()}},{key:"render",value:function(){return this.state.user?Object(b.jsx)(e,{user:this.state.user}):Object(b.jsx)(S.a,{animation:"grow"})}}]),a}(r.Component);return Object(h.b)((function(e){return{token:e.token}}),(function(e){return{logout:function(){return e({type:v})}}}))(n)}var $=function(){return Object(b.jsx)("div",{className:"App",children:Object(b.jsxs)(s.c,{children:[Object(b.jsx)(s.a,{path:"/login",component:g}),Object(b.jsx)(s.a,{path:"/",component:Z(Y(J))})]})})},_=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,128)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,s=t.getTTFB;n(e),r(e),a(e),c(e),s(e)}))},ee=n(91),te={token:null},ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:te,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:return Object(B.a)(Object(B.a)({},e),{},{token:t.token});case v:return Object(B.a)(Object(B.a)({},e),{},{token:null});default:return e}},re=n(79),ae=function(){try{var e=localStorage.getItem("state");if(!e)return;return JSON.parse(e)}catch(t){return}}(),ce=Object(ee.a)(ne,ae);ce.subscribe((function(){!function(e){try{var t=JSON.stringify(e);localStorage.setItem("state",t)}catch(n){}}(ce.getState())})),c.a.render(Object(b.jsx)(h.a,{store:ce,children:Object(b.jsx)(re.a,{children:Object(b.jsx)($,{})})}),document.getElementById("root")),_()},90:function(e,t,n){},98:function(e,t,n){}},[[111,1,2]]]);
//# sourceMappingURL=main.01bb5f55.chunk.js.map